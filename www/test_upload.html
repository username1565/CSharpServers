<head>
	<title>Feedback form</title>
</head>
<body>
	<form id="feedback_form" method="POST" action="./feedback">
		<div>
			<input name="email" type="text" placeholder="email@mail.com" value="email@email.com"/>
			<br>
			<input name="subject" type="text" placeholder="subject" value="subject"/>
			<br>
			<textarea name="message" placeholder="message"/>message</textarea>
			<br>
			<input id="attachments" name="attachments" type="file" multiple />
			<br>
			<button type="submit" form="feedback_form" value="Submit">Submit</button>
		</div>
	</form>
	<script>
var form = document.getElementById('feedback_form');
var files = document.getElementById('attachments');

function readFile(file){
			var reader = new FileReader();

			reader.readAsDataURL(file);
				reader.onload = function()
				{
					console.log(reader.result);
					var input = document.createElement('input');
					input.type = 'hidden';
					input.name = file.name;
					input.value = reader.result;
					form.appendChild(input);
				};

			reader.onerror = function() {
				console.log(reader.error);
			};				
}

files.addEventListener(
	'change',
	function(e){
		console.log(e);
		for(var i = 0; i<files.files.length; i++){
			var file = files.files[i];
			console.log(file);
			readFile(file);
		}
	}
);
	</script>
</body>
</html>